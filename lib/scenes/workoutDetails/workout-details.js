var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _Ionicons=_interopRequireDefault(require("@expo/vector-icons/Ionicons"));var _services=require("../../services");var _config=_interopRequireDefault(require("../../utils/config"));var _styles=require("../../styles");var _molecules=require("../../components/molecules");var _organisms=require("../../components/organisms");var _jsxFileName="/Users/wanda.chereji/development/WorkoutAssistant/src/scenes/workoutDetails/workout-details.js";var SEPARATOR="+";function Screen(_ref){var data=_ref.data,navi=_ref.navi,goal=_ref.goal;return _react.default.createElement(_reactNative.View,{__source:{fileName:_jsxFileName,lineNumber:28,columnNumber:9}},_react.default.createElement(_reactNative.Text,{style:styles.goal,__source:{fileName:_jsxFileName,lineNumber:29,columnNumber:13}},"Goal: ",goal),_react.default.createElement(_reactNative.SectionList,{style:styles.listContainer,sections:data,renderItem:function renderItem(_ref2){var item=_ref2.item;return _react.default.createElement(Item,{text:item,navi:navi,__source:{fileName:_jsxFileName,lineNumber:33,columnNumber:41}});},renderSectionHeader:function renderSectionHeader(_ref3){var section=_ref3.section;return _react.default.createElement(SectionHeader,{title:section.title.split(SEPARATOR)[0],__source:{fileName:_jsxFileName,lineNumber:34,columnNumber:53}});},keyExtractor:function keyExtractor(item,index){return index;},renderSectionFooter:function renderSectionFooter(_ref4){var section=_ref4.section;return _react.default.createElement(_reactNative.Button,{title:"Add exercises to this workout day",onPress:function onPress(){handleSectionFooterSelection(section,navi);},color:_styles.Colors.PRIMARY_COLOR,__source:{fileName:_jsxFileName,lineNumber:37,columnNumber:28}});},__source:{fileName:_jsxFileName,lineNumber:30,columnNumber:13}}));}function handleSectionFooterSelection(section,navi){var exerciseday=section.title.split(SEPARATOR)[1];var order=section.data.length+1;console.log("handleSectionFooterSelection","exerciseday: ",exerciseday,"order: "+order);callSetService(order,exerciseday);navi.navigate(_config.default.WORKOUT_ADD_EXERCISE_SCREEN);}function callSetService(order,exerciseday){var body={"order":order,"sets":null,"exerciseday":exerciseday,"exercises":[]};console.log(body);var request={url:_config.default.WGER_API_PATH+_config.default.WGER_SET_ENDPOINT,method:'POST',body:JSON.stringify(body)};}function processSetServiceResponse(){}var Item=function Item(_ref5){var text=_ref5.text,navi=_ref5.navi;var exerciseData=text.split(SEPARATOR);return _react.default.createElement(_reactNative.TouchableOpacity,{style:styles.exerciseContainer,onPress:function onPress(){},__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:9}},_react.default.createElement(_Ionicons.default,{name:"ios-fitness",style:styles.exerciseImage,__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:13}}),_react.default.createElement(_reactNative.Text,{style:styles.exerciseName,__source:{fileName:_jsxFileName,lineNumber:87,columnNumber:13}},exerciseData[0],"\n",_react.default.createElement(_reactNative.Text,{style:styles.exerciseRepetitions,__source:{fileName:_jsxFileName,lineNumber:90,columnNumber:17}},exerciseData[1])));};var SectionHeader=function SectionHeader(_ref6){var title=_ref6.title;return _react.default.createElement(_reactNative.Text,{style:styles.sectionHeader,__source:{fileName:_jsxFileName,lineNumber:97,columnNumber:5}},title);};var WorkoutDetailsScreen=function WorkoutDetailsScreen(_ref7){var route=_ref7.route,navigation=_ref7.navigation;var _useState=(0,_react.useState)(true),_useState2=(0,_slicedToArray2.default)(_useState,2),isLoading=_useState2[0],setLoading=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=(0,_slicedToArray2.default)(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=(0,_react.useState)(""),_useState6=(0,_slicedToArray2.default)(_useState5,2),goal=_useState6[0],setGoal=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=(0,_slicedToArray2.default)(_useState7,2),showAddTrainingIcon=_useState8[0],setAddTrainingIconVisibility=_useState8[1];var _useState9=(0,_react.useState)(false),_useState10=(0,_slicedToArray2.default)(_useState9,2),displayAddTrainingDayModal=_useState10[0],setAddTrainingDayModalVisibility=_useState10[1];var _useState11=(0,_react.useState)(""),_useState12=(0,_slicedToArray2.default)(_useState11,2),newTrainingDayId=_useState12[0],setNewTrainingDayId=_useState12[1];(0,_react.useEffect)(function(){(0,_services.getWorkoutByIdService)(route.params.itemId,processWorkoutByIdServiceResult);},[newTrainingDayId]);_react.default.useLayoutEffect(function(){navigation.setOptions({headerRight:function headerRight(){return showAddTrainingIcon?_react.default.createElement(_molecules.HeaderButton,{icon:"baseline_add_white_24dp",onIconPress:function onIconPress(){showAddTrainingDayModal();},__source:{fileName:_jsxFileName,lineNumber:115,columnNumber:35}}):null;}});},[navigation,showAddTrainingIcon]);function processWorkoutByIdServiceResult(apiCallOutcome,responseJson){switch(apiCallOutcome){case _config.default.RESPONSE_RECEIVED:var data=[];var trainingDays=[];responseJson.day_list.forEach(function(day){var exerciseObj={};var title=day.days_of_week.text+" - "+day.obj.description;var id=day.obj.id;exerciseObj.title=title+SEPARATOR+id;trainingDays=trainingDays.concat(day.obj.day);exerciseObj.data=[];day.set_list.forEach(function(set){if(set){set.exercise_list.forEach(function(exercise){exerciseObj.data.push(exercise.obj.name+SEPARATOR+exercise.setting_text);});}});data=[].concat((0,_toConsumableArray2.default)(data),[exerciseObj]);});setGoal(responseJson.obj.comment);setData(data);if(trainingDays.length===0)setAddTrainingIconVisibility(true);break;case _config.default.API_CALL_COMPLETED:setLoading(false);break;}}function showAddTrainingDayModal(){setAddTrainingDayModalVisibility(true);}function makeAddWorkoutDayServiceCall(description,days){setLoading(true);var body={"description":description,"training":route.params.itemId,"day":days};var request={url:_config.default.WGER_API_PATH+_config.default.WGER_DAY_ENDPOINT,method:'POST',body:JSON.stringify(body)};(0,_services.dayService)(request,processDayServiceResponse);}function processDayServiceResponse(apiCallOutcome,responseJson){switch(apiCallOutcome){case _config.default.RESPONSE_RECEIVED:setNewTrainingDayId(responseJson.id);setAddTrainingIconVisibility(false);break;case _config.default.API_CALL_COMPLETED:setLoading(false);break;}}return _react.default.createElement(_reactNative.SafeAreaView,{style:styles.container,__source:{fileName:_jsxFileName,lineNumber:197,columnNumber:9}},isLoading?_react.default.createElement(_reactNative.ActivityIndicator,{__source:{fileName:_jsxFileName,lineNumber:198,columnNumber:26}}):_react.default.createElement(Screen,{data:data,navi:navigation,goal:goal,__source:{fileName:_jsxFileName,lineNumber:199,columnNumber:17}}),_react.default.createElement(_organisms.AddTrainingDayModal,{isVisible:displayAddTrainingDayModal,setVisible:setAddTrainingDayModalVisibility,callAddDayService:makeAddWorkoutDayServiceCall,__source:{fileName:_jsxFileName,lineNumber:202,columnNumber:13}}));};var styles=_reactNative.StyleSheet.create({container:{flex:1,paddingTop:20,paddingLeft:12,paddingRight:12,paddingBottom:50,backgroundColor:_styles.Colors.WHITE},listContainer:{paddingLeft:12},sectionHeader:{paddingTop:4,paddingBottom:4,fontSize:10,color:_styles.Colors.ACCENT_COLOR,textTransform:'uppercase'},exerciseContainer:{flex:1,flexDirection:'row',marginLeft:8,marginRight:4,marginTop:8,marginBottom:8,borderColor:_styles.Colors.PRIMARY_COLOR,borderWidth:1,borderRadius:8,alignItems:'center'},exerciseImage:{paddingLeft:16,paddingRight:8,fontSize:80,color:_styles.Colors.PRIMARY_COLOR},exerciseName:{padding:8,fontSize:18,color:_styles.Colors.PRIMARY_COLOR},exerciseRepetitions:{paddingRight:8,paddingBottom:8,fontSize:12,color:_styles.Colors.PRIMARY_COLOR},goal:{paddingTop:4,paddingBottom:12,fontSize:18,color:_styles.Colors.PRIMARY_COLOR,textTransform:'uppercase'}});var _default=WorkoutDetailsScreen;exports.default=_default;